(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1499],{81141:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t,r)=>(()=>{var i=[,t=>{"use strict";t.exports=e},e=>{"use strict";e.exports=t},e=>{"use strict";e.exports=r},(e,t,r)=>{e=r.nmd(e);var i,n=function(e){"use strict";var t=l(9007199254740992),r=Math.log(9007199254740992);function i(e,t){return void 0===e?i[0]:void 0!==t?10==+t?H(e):q(e,t):H(e)}function s(e,t){this.value=e,this.sign=t,this.isSmall=!1}function o(e){this.value=e,this.sign=e<0,this.isSmall=!0}function a(e){return -9007199254740992<e&&e<9007199254740992}function l(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function u(e){h(e);var r=e.length;if(r<4&&0>P(e,t))switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+1e7*e[1];default:return e[0]+(e[1]+1e7*e[2])*1e7}return e}function h(e){for(var t=e.length;0===e[--t];);e.length=t+1}function d(e){for(var t=Array(e),r=-1;++r<e;)t[r]=0;return t}function p(e){return e>0?Math.floor(e):Math.ceil(e)}function g(e,t){var r,i,n=e.length,s=t.length,o=Array(n),a=0;for(i=0;i<s;i++)a=(r=e[i]+t[i]+a)>=1e7?1:0,o[i]=r-1e7*a;for(;i<n;)a=1e7===(r=e[i]+a)?1:0,o[i++]=r-1e7*a;return a>0&&o.push(a),o}function c(e,t){return e.length>=t.length?g(e,t):g(t,e)}function f(e,t){var r,i,n=e.length,s=Array(n);for(i=0;i<n;i++)t=Math.floor((r=e[i]-1e7+t)/1e7),s[i]=r-1e7*t,t+=1;for(;t>0;)s[i++]=t%1e7,t=Math.floor(t/1e7);return s}function m(e,t){var r,i,n=e.length,s=t.length,o=Array(n),a=0;for(r=0;r<s;r++)(i=e[r]-a-t[r])<0?(i+=1e7,a=1):a=0,o[r]=i;for(r=s;r<n;r++){if((i=e[r]-a)<0)i+=1e7;else{o[r++]=i;break}o[r]=i}for(;r<n;r++)o[r]=e[r];return h(o),o}function _(e,t,r){var i,n,a=e.length,l=Array(a),h=-t;for(i=0;i<a;i++)h=Math.floor((n=e[i]+h)/1e7),n%=1e7,l[i]=n<0?n+1e7:n;return"number"==typeof(l=u(l))?(r&&(l=-l),new o(l)):new s(l,r)}function y(e,t){var r,i,n,s,o=e.length,a=t.length,l=d(o+a);for(n=0;n<o;++n){s=e[n];for(var u=0;u<a;++u)i=Math.floor((r=s*t[u]+l[n+u])/1e7),l[n+u]=r-1e7*i,l[n+u+1]+=i}return h(l),l}function v(e,t){var r,i,n=e.length,s=Array(n),o=0;for(i=0;i<n;i++)o=Math.floor((r=e[i]*t+o)/1e7),s[i]=r-1e7*o;for(;o>0;)s[i++]=o%1e7,o=Math.floor(o/1e7);return s}function b(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function S(e,t,r){return e<1e7?new s(v(t,e),r):new s(y(t,l(e)),r)}function E(e){var t,r,i,n,s=e.length,o=d(s+s);for(i=0;i<s;i++){r=0-(n=e[i])*n;for(var a=i;a<s;a++)r=Math.floor((t=n*e[a]*2+o[i+a]+r)/1e7),o[i+a]=t-1e7*r;o[i+s]=r}return h(o),o}function w(e,t){var r,i,n,s,o=e.length,a=d(o);for(n=0,r=o-1;r>=0;--r)i=p((s=1e7*n+e[r])/t),n=s-i*t,a[r]=0|i;return[a,0|n]}function R(e,t){var r,n,a=H(t),g=e.value,c=a.value;if(0===c)throw Error("Cannot divide by zero");if(e.isSmall)return a.isSmall?[new o(p(g/c)),new o(g%c)]:[i[0],e];if(a.isSmall){if(1===c)return[e,i[0]];if(-1==c)return[e.negate(),i[0]];var f=Math.abs(c);if(f<1e7){r=u((n=w(g,f))[0]);var _=n[1];return(e.sign&&(_=-_),"number"==typeof r)?(e.sign!==a.sign&&(r=-r),[new o(r),new o(_)]):[new s(r,e.sign!==a.sign),new o(_)]}c=l(f)}var y=P(g,c);if(-1===y)return[i[0],e];if(0===y)return[i[e.sign===a.sign?1:-1],i[0]];r=(n=g.length+c.length<=200?function(e,t){var r,i,n,s,o,a,l,h=e.length,p=t.length,g=d(t.length),c=t[p-1],f=Math.ceil(1e7/(2*c)),m=v(e,f),_=v(t,f);for(m.length<=h&&m.push(0),_.push(0),c=_[p-1],i=h-p;i>=0;i--){for(r=1e7-1,m[i+p]!==c&&(r=Math.floor((1e7*m[i+p]+m[i+p-1])/c)),n=0,s=0,a=_.length,o=0;o<a;o++)n+=r*_[o],l=Math.floor(n/1e7),s+=m[i+o]-(n-1e7*l),n=l,s<0?(m[i+o]=s+1e7,s=-1):(m[i+o]=s,s=0);for(;0!==s;){for(r-=1,n=0,o=0;o<a;o++)(n+=m[i+o]-1e7+_[o])<0?(m[i+o]=n+1e7,n=0):(m[i+o]=n,n=1);s+=n}g[i]=r}return m=w(m,f)[0],[u(g),u(m)]}(g,c):function(e,t){for(var r,i,n,s,o,a=e.length,l=t.length,d=[],p=[];a;){if(p.unshift(e[--a]),h(p),0>P(p,t)){d.push(0);continue}i=p.length,n=1e7*p[i-1]+p[i-2],s=1e7*t[l-1]+t[l-2],i>l&&(n=(n+1)*1e7),r=Math.ceil(n/s);do{if(0>=P(o=v(t,r),p))break;r--}while(r);d.push(r),p=m(p,o)}return d.reverse(),[u(d),u(p)]}(g,c))[0];var b=e.sign!==a.sign,S=n[1],E=e.sign;return"number"==typeof r?(b&&(r=-r),r=new o(r)):r=new s(r,b),"number"==typeof S?(E&&(S=-S),S=new o(S)):S=new s(S,E),[r,S]}function P(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function M(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(25)||void 0))}s.prototype=Object.create(i.prototype),o.prototype=Object.create(i.prototype),s.prototype.add=function(e){var t=H(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,i=t.value;return t.isSmall?new s(f(r,Math.abs(i)),this.sign):new s(c(r,i),this.sign)},s.prototype.plus=s.prototype.add,o.prototype.add=function(e){var t=H(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var i=t.value;if(t.isSmall){if(a(r+i))return new o(r+i);i=l(Math.abs(i))}return new s(f(i,Math.abs(r)),r<0)},o.prototype.plus=o.prototype.add,s.prototype.subtract=function(e){var t,r,i=H(e);if(this.sign!==i.sign)return this.add(i.negate());var n=this.value,a=i.value;return i.isSmall?_(n,Math.abs(a),this.sign):(t=this.sign,(P(n,a)>=0?r=m(n,a):(r=m(a,n),t=!t),"number"==typeof(r=u(r)))?(t&&(r=-r),new o(r)):new s(r,t))},s.prototype.minus=s.prototype.subtract,o.prototype.subtract=function(e){var t=H(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var i=t.value;return t.isSmall?new o(r-i):_(i,Math.abs(r),r>=0)},o.prototype.minus=o.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},o.prototype.negate=function(){var e=this.sign,t=new o(-this.value);return t.sign=!e,t},s.prototype.abs=function(){return new s(this.value,!1)},o.prototype.abs=function(){return new o(Math.abs(this.value))},s.prototype.multiply=function(e){var t,r,n,o=H(e),a=this.value,u=o.value,d=this.sign!==o.sign;if(o.isSmall){if(0===u)return i[0];if(1===u)return this;if(-1===u)return this.negate();if((n=Math.abs(u))<1e7)return new s(v(a,n),d);u=l(n)}return -.012*(t=a.length)-.012*(r=u.length)+15e-6*t*r>0?new s(function e(t,r){var i=Math.max(t.length,r.length);if(i<=30)return y(t,r);i=Math.ceil(i/2);var n=t.slice(i),s=t.slice(0,i),o=r.slice(i),a=r.slice(0,i),l=e(s,a),u=e(n,o),d=e(c(s,n),c(a,o)),p=c(c(l,b(m(m(d,l),u),i)),b(u,2*i));return h(p),p}(a,u),d):new s(y(a,u),d)},s.prototype.times=s.prototype.multiply,o.prototype._multiplyBySmall=function(e){return a(e.value*this.value)?new o(e.value*this.value):S(Math.abs(e.value),l(Math.abs(this.value)),this.sign!==e.sign)},s.prototype._multiplyBySmall=function(e){return 0===e.value?i[0]:1===e.value?this:-1===e.value?this.negate():S(Math.abs(e.value),this.value,this.sign!==e.sign)},o.prototype.multiply=function(e){return H(e)._multiplyBySmall(this)},o.prototype.times=o.prototype.multiply,s.prototype.square=function(){return new s(E(this.value),!1)},o.prototype.square=function(){var e=this.value*this.value;return a(e)?new o(e):new s(E(l(Math.abs(this.value))),!1)},s.prototype.divmod=function(e){var t=R(this,e);return{quotient:t[0],remainder:t[1]}},o.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(e){return R(this,e)[0]},o.prototype.over=o.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(e){return R(this,e)[1]},o.prototype.remainder=o.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(e){var t,r,n,s=H(e),l=this.value,u=s.value;if(0===u)return i[1];if(0===l)return i[0];if(1===l)return i[1];if(-1===l)return s.isEven()?i[1]:i[-1];if(s.sign)return i[0];if(!s.isSmall)throw Error("The exponent "+s.toString()+" is too large.");if(this.isSmall&&a(t=Math.pow(l,u)))return new o(p(t));for(r=this,n=i[1];!0&u&&(n=n.times(r),--u),0!==u;)u/=2,r=r.square();return n},o.prototype.pow=s.prototype.pow,s.prototype.modPow=function(e,t){if(e=H(e),(t=H(t)).isZero())throw Error("Cannot take modPow with modulus 0");for(var r=i[1],n=this.mod(t);e.isPositive();){if(n.isZero())return i[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t)}return r},o.prototype.modPow=s.prototype.modPow,s.prototype.compareAbs=function(e){var t=H(e),r=this.value,i=t.value;return t.isSmall?1:P(r,i)},o.prototype.compareAbs=function(e){var t=H(e),r=Math.abs(this.value),i=t.value;return t.isSmall?r===(i=Math.abs(i))?0:r>i?1:-1:-1},s.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=H(e),r=this.value,i=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:P(r,i)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,o.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=H(e),r=this.value,i=t.value;return t.isSmall?r==i?0:r>i?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},o.prototype.compareTo=o.prototype.compare,s.prototype.equals=function(e){return 0===this.compare(e)},o.prototype.eq=o.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(e){return 0!==this.compare(e)},o.prototype.neq=o.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(e){return this.compare(e)>0},o.prototype.gt=o.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(e){return 0>this.compare(e)},o.prototype.lt=o.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},o.prototype.geq=o.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(e){return 0>=this.compare(e)},o.prototype.leq=o.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return(1&this.value[0])==0},o.prototype.isEven=function(){return(1&this.value)==0},s.prototype.isOdd=function(){return(1&this.value[0])==1},o.prototype.isOdd=function(){return(1&this.value)==1},s.prototype.isPositive=function(){return!this.sign},o.prototype.isPositive=function(){return this.value>0},s.prototype.isNegative=function(){return this.sign},o.prototype.isNegative=function(){return this.value<0},s.prototype.isUnit=function(){return!1},o.prototype.isUnit=function(){return 1===Math.abs(this.value)},s.prototype.isZero=function(){return!1},o.prototype.isZero=function(){return 0===this.value},s.prototype.isDivisibleBy=function(e){var t=H(e),r=t.value;return 0!==r&&(1===r||(2===r?this.isEven():this.mod(t).equals(i[0])))},o.prototype.isDivisibleBy=s.prototype.isDivisibleBy,s.prototype.isPrime=function(){var e=M(this);if(void 0!==e)return e;for(var t,r,s,o,a=this.abs(),l=a.prev(),u=[2,3,5,7,11,13,17,19],h=l;h.isEven();)h=h.divide(2);for(s=0;s<u.length;s++)if(!((o=n(u[s]).modPow(h,a)).equals(i[1])||o.equals(l))){for(r=!0,t=h;r&&t.lesser(l);t=t.multiply(2))(o=o.square().mod(a)).equals(l)&&(r=!1);if(r)return!1}return!0},o.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(e){var t=M(this);if(void 0!==t)return t;for(var r=this.abs(),i=void 0===e?5:e,s=0;s<i;s++)if(!n.randBetween(2,r.minus(2)).modPow(r.prev(),r).isUnit())return!1;return!0},o.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(e){for(var t,r,i,s=n.zero,o=n.one,a=H(e),l=this.abs();!l.equals(n.zero);)t=a.divide(l),r=s,i=a,s=o,a=l,o=r.subtract(t.multiply(o)),l=i.subtract(t.multiply(l));if(!a.equals(1))throw Error(this.toString()+" and "+e.toString()+" are not co-prime");return(-1===s.compare(0)&&(s=s.add(e)),this.isNegative())?s.negate():s},o.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var e=this.value;return this.sign?_(e,1,this.sign):new s(f(e,1),this.sign)},o.prototype.next=function(){var e=this.value;return e+1<9007199254740992?new o(e+1):new s(t,!1)},s.prototype.prev=function(){var e=this.value;return this.sign?new s(f(e,1),!0):_(e,1,this.sign)},o.prototype.prev=function(){var e=this.value;return e-1>-9007199254740992?new o(e-1):new s(t,!0)};for(var A=[1];2*A[A.length-1]<=1e7;)A.push(2*A[A.length-1]);var T=A.length,U=A[T-1];function x(e){return("number"==typeof e||"string"==typeof e)&&1e7>=+Math.abs(e)||e instanceof s&&e.value.length<=1}function D(e,t,r){t=H(t);for(var i=e.isNegative(),s=t.isNegative(),o=i?e.not():e,a=s?t.not():t,l=0,u=0,h=null,d=null,p=[];!o.isZero()||!a.isZero();)l=(h=R(o,U))[1].toJSNumber(),i&&(l=U-1-l),u=(d=R(a,U))[1].toJSNumber(),s&&(u=U-1-u),o=h[0],a=d[0],p.push(r(l,u));for(var g=0!==r(i?1:0,s?1:0)?n(-1):n(0),c=p.length-1;c>=0;c-=1)g=g.multiply(U).add(n(p[c]));return g}function L(e){var t=e.value,r="number"==typeof t?1073741824|t:t[0]+1e7*t[1]|1073758208;return r&-r}function I(e,t){return e=H(e),t=H(t),e.greater(t)?e:t}function C(e,t){return e=H(e),t=H(t),e.lesser(t)?e:t}function N(e,t){if(e=H(e).abs(),t=H(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,s=i[1];e.isEven()&&t.isEven();)r=Math.min(L(e),L(t)),e=e.divide(r),t=t.divide(r),s=s.multiply(r);for(;e.isEven();)e=e.divide(L(e));do{for(;t.isEven();)t=t.divide(L(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e)}while(!t.isZero());return s.isUnit()?e:e.multiply(s)}s.prototype.shiftLeft=function(e){if(!x(e))throw Error(String(e)+" is too large for shifting.");if((e=+e)<0)return this.shiftRight(-e);var t=this;if(t.isZero())return t;for(;e>=T;)t=t.multiply(U),e-=T-1;return t.multiply(A[e])},o.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(e){if(!x(e))throw Error(String(e)+" is too large for shifting.");if((e=+e)<0)return this.shiftLeft(-e);for(var t,r=this;e>=T;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(t=R(r,U))[1].isNegative()?t[0].prev():t[0],e-=T-1}return(t=R(r,A[e]))[1].isNegative()?t[0].prev():t[0]},o.prototype.shiftRight=s.prototype.shiftRight,s.prototype.not=function(){return this.negate().prev()},o.prototype.not=s.prototype.not,s.prototype.and=function(e){return D(this,e,function(e,t){return e&t})},o.prototype.and=s.prototype.and,s.prototype.or=function(e){return D(this,e,function(e,t){return e|t})},o.prototype.or=s.prototype.or,s.prototype.xor=function(e){return D(this,e,function(e,t){return e^t})},o.prototype.xor=s.prototype.xor,s.prototype.bitLength=function(){var e=this;return(0>e.compareTo(n(0))&&(e=e.negate().subtract(n(1))),0===e.compareTo(n(0)))?n(0):n(function e(t,r){if(0>=r.compareTo(t)){var i=e(t,r.square(r)),s=i.p,o=i.e,a=s.multiply(r);return 0>=a.compareTo(t)?{p:a,e:2*o+1}:{p:s,e:2*o}}return{p:n(1),e:0}}(e,n(2)).e).add(n(1))},o.prototype.bitLength=s.prototype.bitLength;var q=function(e,t){for(var i,n=e.length,s=Math.abs(t),i=0;i<n;i++){var a=e[i].toLowerCase();if("-"!==a&&/[a-z0-9]/.test(a)){if(/[0-9]/.test(a)&&+a>=s){if("1"===a&&1===s)continue;throw Error(a+" is not a valid digit in base "+t+".")}if(a.charCodeAt(0)-87>=s)throw Error(a+" is not a valid digit in base "+t+".")}}if(2<=t&&t<=36&&n<=r/Math.log(t)){if(isNaN(parseInt(e,t)))throw Error(a+" is not a valid digit in base "+t+".");return new o(parseInt(e,t))}t=H(t);var l=[],u="-"===e[0];for(i=u?1:0;i<e.length;i++){var a=e[i].toLowerCase(),h=a.charCodeAt(0);if(48<=h&&h<=57)l.push(H(a));else if(97<=h&&h<=122)l.push(H(a.charCodeAt(0)-87));else if("<"===a){var d=i;do i++;while(">"!==e[i]);l.push(H(e.slice(d+1,i)))}else throw Error(a+" is not a valid character")}return O(l,t,u)};function O(e,t,r){var n,s=i[0],o=i[1];for(n=e.length-1;n>=0;n--)s=s.add(e[n].times(o)),o=o.times(t);return r?s.negate():s}function k(e){return e<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e):"<"+e+">"}function B(e,t){if((t=n(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e)).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(+e-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var i=!1;if(e.isNegative()&&t.isPositive()&&(i=!0,e=e.abs()),t.equals(1))return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(+e)).map(Number.prototype.valueOf,1),isNegative:i};for(var s,o=[],a=e;a.isNegative()||a.compareAbs(t)>=0;){a=(s=a.divmod(t)).quotient;var l=s.remainder;l.isNegative()&&(l=t.minus(l).abs(),a=a.next()),o.push(l.toJSNumber())}return o.push(a.toJSNumber()),{value:o.reverse(),isNegative:i}}function z(e,t){var r=B(e,t);return(r.isNegative?"-":"")+r.value.map(k).join("")}function F(e){if(a(+e)){var t=+e;if(t===p(t))return new o(t);throw Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var i=e.split(/e/i);if(i.length>2)throw Error("Invalid integer: "+i.join("e"));if(2===i.length){var n=i[1];if("+"===n[0]&&(n=n.slice(1)),(n=+n)!==p(n)||!a(n))throw Error("Invalid integer: "+n+" is not a valid exponent.");var l=i[0],u=l.indexOf(".");if(u>=0&&(n-=l.length-u-1,l=l.slice(0,u)+l.slice(u+1)),n<0)throw Error("Cannot include negative exponent part for integers");l+=Array(n+1).join("0"),e=l}if(!/^([0-9][0-9]*)$/.test(e))throw Error("Invalid integer: "+e);for(var d=[],g=e.length,c=g-7;g>0;)d.push(+e.slice(c,g)),(c-=7)<0&&(c=0),g-=7;return h(d),new s(d,r)}function H(e){return"number"==typeof e?function(e){if(a(e)){if(e!==p(e))throw Error(e+" is not an integer.");return new o(e)}return F(e.toString())}(e):"string"==typeof e?F(e):e}s.prototype.toArray=function(e){return B(this,e)},o.prototype.toArray=function(e){return B(this,e)},s.prototype.toString=function(t){if(e===t&&(t=10),10!==t)return z(this,t);for(var r,i=this.value,n=i.length,s=String(i[--n]);--n>=0;)r=String(i[n]),s+="0000000".slice(r.length)+r;return(this.sign?"-":"")+s},o.prototype.toString=function(t){return(e===t&&(t=10),10!=t)?z(this,t):String(this.value)},s.prototype.toJSON=o.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return parseInt(this.toString(),10)},s.prototype.toJSNumber=s.prototype.valueOf,o.prototype.valueOf=function(){return this.value},o.prototype.toJSNumber=o.prototype.valueOf;for(var j=0;j<1e3;j++)i[j]=new o(j),j>0&&(i[-j]=new o(-j));return i.one=i[1],i.zero=i[0],i.minusOne=i[-1],i.max=I,i.min=C,i.gcd=N,i.lcm=function(e,t){return e=H(e).abs(),t=H(t).abs(),e.divide(N(e,t)).multiply(t)},i.isInstance=function(e){return e instanceof s||e instanceof o},i.randBetween=function(e,t){var r=C(e=H(e),t=H(t)),i=I(e,t).subtract(r).add(1);if(i.isSmall)return r.add(Math.floor(Math.random()*i));for(var n=i.value.length-1,a=[],l=!0,h=n;h>=0;h--){var d=l?i.value[h]:1e7,g=p(Math.random()*d);a.unshift(g),g<d&&(l=!1)}return a=u(a),r.add("number"==typeof a?new o(a):new s(a,!1))},i.fromArray=function(e,t,r){return O(e.map(H),H(t||10),r)},i}();e.hasOwnProperty("exports")&&(e.exports=n),void 0!==(i=(function(){return n}).apply(t,[]))&&(e.exports=i)}],n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return i[e](r,r.exports,s),r.loaded=!0,r.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var o={};return(()=>{"use strict";s.r(o),s.d(o,{HLSMSEPlayer:()=>j,buildNumber:()=>K,errors:()=>t,retrievalErrors:()=>i.retrievalErrors,version:()=>J});var e,t,r=s(1),i=s(2),n=s(3),a=s(4);function l(e,t){let r=e.byteLength,i=0;for(;i<r;){let n=e.getUint32(i);if(1===n)throw Error("Large atom size not supported.");if(0===n&&(n=r-i),t(e.getUint32(i+4),new DataView(e.buffer,e.byteOffset+i+8,n-8)))break;i+=n}}let u=r.helpers.deferred.buildDeferred,h=n.helpers.timeRanges.buildTimeRanges,d=r.helpers.Promise,{prefixLogger:p,noOpLogger:g}=r.logger,c=r.helpers.browser.isIE(),f=r.helpers.browser.isSafari(),m=r.helpers.browser.isEdge(),_='audio/mp4; codecs="mp3"',y=r.helpers.browser.getSafariVersion(),v=r.helpers.browser.getChromeVersion(),b=f||!!(v&&v.major<=49),S=!!y&&y.major<10&&y.major>=5||!!v&&v.major<=49,E=Error("MSE killed.");class w{constructor(e,t=g){if(this._sourceBuffer=null,this._initialized=!1,this._initializeDeferred=u(),this._whenIdleDeferred=u(),this._error=null,this._dead=!1,this._eosSignalled=!1,this._pendingActions=[],this._currentAction=null,this._pendingStartTime=0,this._logger=p(t,"MSE"),this._onMediaSourceInit=this._onMediaSourceInit.bind(this),this._onMediaSourceError=this._onMediaSourceError.bind(this),this._onSourceBufferUpdateEnd=this._onSourceBufferUpdateEnd.bind(this),this._onSourceBufferError=this._onSourceBufferError.bind(this),!new.target.isSupported(e))throw this._logger.error("Not supported."),Error("Not supported.");f&&e===_&&(e="audio/mp4"),this._type=e,this._useSegmentsMode=S&&0===e.indexOf("audio/mp4"),this._mediaSource=new MediaSource,this._mediaSource.addEventListener("sourceopen",this._onMediaSourceInit,!1),this._mediaSource.addEventListener("error",this._onMediaSourceError,!1),this._mediaSource.addEventListener("sourceended",this._onSourceBufferUpdateEnd,!1),this._url=URL.createObjectURL(this._mediaSource),this._logger.debug("Created URL.",this._url)}static isSupported(e){return!c&&!!window.MediaSource&&(!e||!!f&&e===_||(!y||!(y.major<10)||"audio/mpeg"!==e)&&(!v||!(v.major<50)||'audio/webm; codecs="opus"'!==e)&&MediaSource.isTypeSupported(e))}whenInitialized(){return this._initializeDeferred.promise}whenIdle(){return this._whenIdleDeferred?this._whenIdleDeferred.promise:d.resolve(void 0)}isIdle(){return this._dead||!this._whenIdleDeferred}hasInitialized(){return this._initialized}getError(){return this._error}getUrl(){return this._ensureNotDead(),this._url}getBuffered(){if(this._ensureNotDead(),!this._sourceBuffer)return[];try{return h(this._sourceBuffer.buffered)}catch(e){if("InvalidStateError"===e.name&&"Failed to read the 'buffered' property from 'SourceBuffer': This SourceBuffer has been removed from the parent media source."===e.message)return[];throw e}}append(e,t=null){if(this._ensureNotDead(),this._ensureInitialized(),this._logger.debug("append() called.",t),b&&0===this._type.indexOf("audio/mp4")){this._logger.debug("Rewriting internal timestamp to 0.");try{e=function(e,t=!1){let i=e=>{let t=e.getUint8(0);e.setUint32(12,0),t>0&&e.setUint32(16,0)},n=e=>{l(e,(e,t)=>1953653094===e&&(s(t),!0))},s=e=>{l(e,(e,t)=>1952867444===e&&(o(t),!0))},o=e=>{let r;let i=e.getUint8(0);t?r=a(0):(r=a(e.getUint32(4)),i>0&&(r=(r=r.shiftLeft(32)).add(e.getUint32(8))),null===h&&(h=r),r=r.subtract(h)),i>0?(e.setUint32(4,r.shiftRight(32).toJSNumber()),e.setUint32(8,r.and(65535).toJSNumber())):e.setUint32(4,r.toJSNumber())},u=r.helpers.arrayBuffer.combine([e]),h=null;return l(new DataView(u.buffer,u.byteOffset,u.byteLength),(e,t)=>{switch(e){case 1936286840:i(t);break;case 1836019558:n(t)}return!1}),u}(e,!this._useSegmentsMode)}catch(e){return this._logger.error("Error rewriting timestamps.",e),this._handleError(e),d.reject(e)}}let i=u();if(null!==t&&this._sourceBuffer&&this._sourceBuffer.buffered.length){let e=new r.TimeRange(0,1/0);this._pendingActions.push({type:"remove",deferred:u(),range:e,abort:!0})}return this._pendingActions.push({type:"append",data:e,deferred:i,startTime:t}),this._eosSignalled=!1,this._performNextAction(),i.promise}remove(e){if(0===e.duration)throw Error("Remove range must have a duration > 0.");this._ensureNotDead(),this._ensureInitialized(),this._logger.debug("remove() called.",e);let t=u();return this._pendingActions.push({type:"remove",range:e,deferred:t,abort:!1}),this._eosSignalled=!1,this._performNextAction(),t.promise}signalEOS(){if(this._ensureNotDead(),this._ensureInitialized(),this._logger.debug("signalEOS() called."),this._eosSignalled)return this._logger.debug("Ignoring because already signalled EOS."),d.resolve();this._eosSignalled=!0;let e=u();return this._pendingActions.push({type:"eos",deferred:e}),this._performNextAction(),e.promise}updateDuration(e){if(e<=0)throw Error("Duration must be > 0.");this._ensureNotDead(),this._ensureInitialized(),this._logger.debug("updateDuration() called.",e);let t=u();return this._pendingActions.push({type:"duration",duration:e,deferred:t}),this._performNextAction(),t.promise}eosSignalled(){return this._eosSignalled}kill(){if(this._dead)return;this._logger.debug("kill() called."),this._dead=!0,this._mediaSource.removeEventListener("sourceopen",this._onMediaSourceInit,!1),this._mediaSource.removeEventListener("sourceended",this._onSourceBufferUpdateEnd,!1),this._mediaSource.removeEventListener("error",this._onMediaSourceError,!1),this._sourceBuffer&&(this._sourceBuffer.removeEventListener("updateend",this._onSourceBufferUpdateEnd,!1),this._sourceBuffer.removeEventListener("error",this._onSourceBufferError,!1)),URL.revokeObjectURL(this._url);let e=this._error||E,t=this._currentAction?[this._currentAction]:[];(t=t.concat(this._pendingActions)).forEach(t=>{t.deferred.reject(e)}),this._whenIdleDeferred||(this._whenIdleDeferred=u()),this._whenIdleDeferred.reject(e),this._initialized||this._initializeDeferred.reject(e),this._pendingActions.length=0,this._logger.debug("Killed.")}_ensureInitialized(){if(!this._initialized)throw Error("Not initialized yet.")}_ensureNotDead(){if(this._error)throw Error("MSE is dead because of error: "+this._error.message);if(this._dead)throw Error("MSE is dead.")}_onMediaSourceInit(){this._logger.debug("MSE initialized."),this._mediaSource.removeEventListener("sourceopen",this._onMediaSourceInit,!1);try{this._logger.debug("Creating source buffer.",this._type),this._sourceBuffer=this._mediaSource.addSourceBuffer(this._type),this._sourceBuffer.mode=this._useSegmentsMode?"segments":"sequence",this._logger.debug(`Using append mode: ${this._sourceBuffer.mode}`),this._sourceBuffer.addEventListener("updateend",this._onSourceBufferUpdateEnd,!1),this._sourceBuffer.addEventListener("error",this._onSourceBufferError,!1)}catch(e){this._handleError(e)}this._initializeDeferred.resolve(void 0),this._whenIdleDeferred.resolve(void 0),this._initialized=!0,this._performNextAction()}_onMediaSourceError(e){this._handleError(e)}_handleError(e){this._logger.error("Error occurred.",e),this._dead||(this._error=e||Error("Unknown error."),this.kill())}_onSourceBufferUpdateEnd(){if(this._dead)return;let e=this._currentAction;if(!e){this._logger.debug("Ignoring stray updateend event.");return}let t=this.getBuffered();this._logger.debug("Update ended.",t),null!==this._pendingStartTime&&r.TimeRange.getCoverage(t).end>this._pendingStartTime&&(this._pendingStartTime=null),this._currentAction=null,e.deferred.resolve(void 0),this._performNextAction()}_onSourceBufferError(e){this._handleError(e)}_performNextAction(){let e=this._whenIdleDeferred;if(this._currentAction||!this._sourceBuffer)return;let t=this._pendingActions.shift();if(t)e||(this._whenIdleDeferred=u());else{this._logger.debug("No more actions."),e&&(this._whenIdleDeferred=null,e.resolve(void 0));return}switch(this._currentAction=t,this._logger.debug("Performing next action...",t),t.type){case"append":{null!==t.startTime&&(this._pendingStartTime=t.startTime);let e=r.TimeRange.getCoverage(this.getBuffered());try{if(null!==this._pendingStartTime)this._setTimestampOffset(this._sourceBuffer,this._pendingStartTime);else if("segments"===this._sourceBuffer.mode){let t=e.end;this._logger.debug('Setting timestampOffset because in "segments" mode.',t),this._setTimestampOffset(this._sourceBuffer,t)}this._logger.debug("Calling appendBuffer()."),this._sourceBuffer.appendBuffer(t.data)}catch(e){this._handleError(e)}break}case"remove":try{let e=t.range;this._logger.debug("Calling remove().",e.start,e.end),!t.abort||f||m||"open"!==this._mediaSource.readyState||this._sourceBuffer.abort(),this._sourceBuffer.remove(e.start/1e3,e.end/1e3)}catch(e){this._handleError(e)}break;case"duration":this._logger.debug("Updating duration.",t.duration);try{this._mediaSource.duration=t.duration/1e3,window.setTimeout(()=>this._onSourceBufferUpdateEnd(),0)}catch(e){this._mediaSource.duration>=t.duration/1e3?(this._logger.warn("Failed to update MSE durtion but ignoring because current one is higher.",e),window.setTimeout(()=>this._onSourceBufferUpdateEnd(),0)):(this._logger.error("Could not update MSE durtion.",e),this._handleError(e))}break;case"eos":try{this._logger.debug("Calling endOfStream()."),this._mediaSource.endOfStream()}catch(e){this._handleError(e)}break;default:this._handleError(Error("Unknown action."))}}_setTimestampOffset(e,t){try{return e.timestampOffset=t/1e3,!0}catch(e){if("InvalidStateError"===e.name)return this._logger.debug("Failed to set timestampOffset.",e),!1;throw e}}}let R=r.eventDispatcher.EventDispatcher,{prefixLogger:P,noOpLogger:M}=r.logger;class A{constructor(e,t,r,i,n=M){this._onAppendQueued=new R,this._onAppendEnd=new R,this._providedStartTime=!1,this._needsInitData=!0,this._updateTimerId=null,this._gcTimerId=null,this._waitingForData=!1,this._started=!1,this._error=null,this._currentRetrieveHandle=null,this._mseInitialized=!1,this._logger=P(n,"SimpleMSE"),this.onAppendQueued=this._onAppendQueued.getHandle(),this.onAppendEnd=this._onAppendEnd.getHandle(),this._mse=e,this._getNextSegmentData=t,this._getPosition=r,this._onError=i,e.whenInitialized().then(()=>{this._mseInitialized=!0,!this._error&&this._started&&(this._logger.debug("MSE initialized. Preparing to update."),this._prepareUpdate())}).catch(e=>{this._error||(this._logger.error("Error when waiting for MSE to initialize.",e),this._handleError(e||Error("Error waiting for MSE to initialize.")))})}start(){if(this._checkNotErrored(),this._started)throw Error("Already started.");this._logger.debug("start() called."),this._scheduleGC(),this._started=!0,this._prepareUpdate()}kill(){this._error||(this._logger.debug("kill() called."),this._error=Error("Killed."),this._clearTimers(),this._logger.debug("Killed."))}waitingForSegmentData(){return this._checkNotErrored(),this._waitingForData}provideNextSegmentData(e){if(this._checkNotErrored(),!this._waitingForData)throw Error("Not waiting for data.");this._logger.debug("Segment data provided."),this._waitingForData=!1,this._update(e)}_prepareUpdate(){if(this._updateTimerId)return;let e=this._mse;if(!this._mseInitialized)return;let t=e.getBuffered(),i=this._getPosition(),n=r.helpers.find(t,e=>e.containsTime(i));if(!n||n.end<=this._getPosition()+15e3){this._logger.debug("Requesting next segment data.");let e=this._getNextSegmentData();e?(this._logger.debug("Got segment data."),this._update(e)):(this._logger.debug("Did not get any data."),this._waitingForData=!0)}else this._scheduleUpdate()}_gc(){if(!this._mseInitialized){this._scheduleGC();return}let e=this._mse,t=r.TimeRange.getCoverage(e.getBuffered()),i=this._getPosition()-5e3;if(t.start<i){let n=new r.TimeRange(t.start,i-t.start);this._logger.debug("Removing media that has been played.",n),e.remove(n).then(()=>{this._logger.debug("Removed media that has been played.",n),this._error||this._scheduleGC()}).catch(e=>{this._logger.error("Error when attempting to remove media that has been played.",n,e),this._error||this._scheduleGC()})}else this._scheduleGC()}_update({data:e,eventRepresentation:t,startTime:i}){let n=this._mse;this._onAppendQueued.dispatch({segment:t}),this._logger.debug("Appending...",t,i);let s=[],o=!1,a=!1,l=!1,u=this._currentRetrieveHandle=e.run(),h=()=>{if(o||this._error)return;let e=s.shift();if(e&&!e.byteLength)this._logger.warn("Got 0 bytes to append. Skipping..."),h();else if(e){o=!0;let r=this._providedStartTime?null:i;this._logger.debug("Appending part...",t,e.byteLength,r),n.append(e,r).then(()=>{this._providedStartTime=!0,o=!1,a=!0,h()}).catch(e=>{this._error||(this._logger.error("Error updating MSE.",e,t),this._handleError(e||Error("Error updating MSE.")))})}else l&&(this._logger.debug("Append finished.",t),a||this._logger.warn("There was nothing to append."),this._currentRetrieveHandle=null,this._onAppendEnd.dispatch({segment:t}),this._prepareUpdate())};u.onProgressUpdate(e=>{let t;t=this._needsInitData&&e.initData?r.helpers.arrayBuffer.combine([e.initData,e.data]):e.data,this._needsInitData=!1,s.push(t),h()}),u.onError(e=>{this._error||(this._logger.error("Error whilst retrieving data.",e,t),this._handleError(e||Error("Error retrieving data for MSE.")))}),u.onCompletion(()=>{this._logger.debug("Got all data for append.",t),l=!0,h()})}_scheduleUpdate(){this._updateTimerId=window.setTimeout(()=>{this._updateTimerId=null,this._prepareUpdate()},500)}_scheduleGC(){this._gcTimerId||(this._gcTimerId=window.setTimeout(()=>{this._gcTimerId=null,this._gc()},2e4))}_checkNotErrored(){if(this._error)throw this._error}_clearTimers(){this._updateTimerId&&(this._logger.debug("Clearing update timer."),window.clearTimeout(this._updateTimerId),this._updateTimerId=null),this._gcTimerId&&(window.clearTimeout(this._gcTimerId),this._gcTimerId=null),this._currentRetrieveHandle&&(this._currentRetrieveHandle.abort(),this._currentRetrieveHandle=null)}_handleError(e){this._error||(this._error=e,this._logger.error("Error occurred.",e),this._clearTimers(),this._onError(e))}}class T extends r.errors.PlayerFatalError{constructor(e){super("An error occurred trying to append to the buffer.",e)}getCode(){return"HLS_MSE_PLAYER.APPEND_ERROR"}}class U extends r.errors.PlayerFatalError{constructor(e){super("An error occurred trying to initialize the buffer.",e)}getCode(){return"HLS_MSE_PLAYER.INITIALIZE_ERROR"}}class x extends r.errors.PlayerError{constructor(e){super("An error occurred when trying to retrieve a playlist/segment/key.",e),this._internalRetrievalError=e}getCode(){return`HLS_MSE_PLAYER.RETRIEVAL_ERROR.${this._internalRetrievalError.getCode()}`}}class D extends r.errors.NotSupportedError{constructor(){super("A transmuxer could not be found.")}getCode(){return"HLS_MSE_PLAYER.NO_TRANSMUXER_ERROR"}}class L extends r.errors.PlayerFatalError{getCode(){return"HLS_MSE_PLAYER.PLAYLIST_UPDATE_ERROR"}}let{find:I,Promise:C}=r.helpers,N=r.helpers.time.now,{PlayerFatalError:q}=r.errors,O=r.eventDispatcher.EventDispatcher,k=r.logger.prefixLogger,B=r.helpers.abortableJob.abortedError,z=r.helpers.browser.isSafari();function F(e){if(!e.hasEnded())return 1/0;{let t=e.getCompleteDuration();if(null===t)throw Error("Expected playlist duration to be available.");return t}}function H(e){let t=I(i.TransmuxerFactory.retrieveTransmuxers(e),t=>{let r=n.helpers.mimeType.buildMimeTypeFromFormat(t.getOutputFormat(),e);return!!r&&w.isSupported(r)})||null;if(!t)return null;let r=t.getOutputFormat(),s=n.helpers.mimeType.buildMimeTypeFromFormat(r,e);return s?{transmuxer:t,mimeType:s}:null}class j extends n.HTML5PlayerBase{constructor(e,t){if(super(t),this._onSegmentRequestQueued=new O,this._onSegmentRequestStart=new O,this._onSegmentRetrieved=new O,this._onSegmentRequestFailed=new O,this._onSegmentReady=new O,this._onSegmentAppendQueued=new O,this._onSegmentAppendEnd=new O,this._playlist=null,this._playlistSegmentRetriever=null,this._playlistUpdateJob=null,this._initialPlaylistRetrieveCompleted=!1,this._playlistUpdateTimer=null,this._earliestAllowedNextUpdateTime=N(),this._mse=null,this._simpleMSE=null,this._transmuxerAndMimeType=null,this._lastSegmentAppended=null,this._maxBufferLength=null,this._cacheSize=null,this._playlistUpdateEventHandle=null,this._playlistDuration=null,this._logger=k(this._logger,"HLSMSEPlayer"),void 0!==t.maxBufferLength&&t.maxBufferLength<0)throw Error("maxBufferLength cannot be < 0.");if(void 0!==t.memoryCacheSize&&t.memoryCacheSize<0)throw Error("memoryCacheSize cannot be < 0.");this.onSegmentRequestQueued=this._onSegmentRequestQueued.getHandle(),this.onSegmentRequestStart=this._onSegmentRequestStart.getHandle(),this.onSegmentRetrieved=this._onSegmentRetrieved.getHandle(),this.onSegmentRequestFailed=this._onSegmentRequestFailed.getHandle(),this.onSegmentReady=this._onSegmentReady.getHandle(),this.onSegmentAppendQueued=this._onSegmentAppendQueued.getHandle(),this.onSegmentAppendEnd=this._onSegmentAppendEnd.getHandle(),this.__descriptor=e,this.__playerDependencies=t,this._queuedPlaylist=e.playlist}static isFormatSupported(e){return!!w.isSupported()&&!!H(e)}getBufferedTimeRanges(){let e=this._playlistSegmentRetriever;return e?r.TimeRange.normalize(e.getSegmentsWithData().map(e=>e.segment.getTimeRange())):[]}getCompleteBufferedTimeRanges(){let e=this._playlistSegmentRetriever;return e?r.TimeRange.normalize(e.getSegmentsWithData().filter(e=>e.complete).map(e=>e.segment.getTimeRange())):[]}getMaxBufferLength(){return this._maxBufferLength}getBufferController(){return{setMaxBufferLength:e=>{if(e<0)throw Error("Max buffer length cannot be < 0.");this._logger.debug("Updating max buffer length.",e),this._maxBufferLength=e,this._playlistSegmentRetriever?this._playlistSegmentRetriever.updateMaxBufferLength(e):this._logger.debug("Cannot update right now. Playlist segment retriever doesn't exist.")}}}switchPlaylist(e){if(this._logger.debug("Updating playlist."),!this._hasInitialized()){this._logger.debug("Cannot update right now. Still initializing."),this._queuedPlaylist=e;return}this._playlistSegmentRetriever&&(this._playlistSegmentRetriever.switchPlaylist(null),this._logger.debug("Removed current URL.")),this._disposePlaylist(),this._setPlaylist(e)}getMemoryCacheMaxSize(){return null!==this._cacheSize?this._cacheSize:1e8}getMemoryCacheUsage(){return this._playlistSegmentRetriever?this._playlistSegmentRetriever.getCacheUsage():0}getMemoryCacheController(){return{setMaxCacheSize:e=>{if(e<0)throw Error("Max size cannot be < 0.");this._cacheSize=e,this._playlistSegmentRetriever&&this._playlistSegmentRetriever.updateCacheSize(e)}}}_canPlay(){if(!w.isSupported())return this._logger.debug("MSE not supported."),C.resolve(!1);let e=H(this.__descriptor.segmentFormat);return e?(this._transmuxerAndMimeType=e,C.resolve(!0)):(this._logger.debug("No transmuxer found."),C.resolve(new D))}_getUrlForMediaElement(){if(!this._mse)throw Error("MSE does not exist.");return this._mse.getUrl()}_handleDurationUpdates(){}_initialize(){let e=this.__playerDependencies;if(null===this._maxBufferLength&&(void 0!==e.maxBufferLength?this._maxBufferLength=e.maxBufferLength:this._maxBufferLength=3e4),this._logger.debug("Initialized max buffer length.",this._maxBufferLength),null===this._cacheSize&&(void 0!==e.memoryCacheSize?this._cacheSize=e.memoryCacheSize:this._cacheSize=1e8),this._logger.debug("Initialized cache size.",this._cacheSize),super._initialize(),!this._queuedPlaylist)throw Error("Playlist should exist.");this._setPlaylist(this._queuedPlaylist),this._queuedPlaylist=null}_initMediaElement(e,t){this._simpleMSE&&(this._simpleMSE.kill(),this._simpleMSE=null,this._logger.debug("Killed SimpleMSE.")),this._mse&&(this._mse.kill(),this._mse=null,this._logger.debug("Killed MSE.")),t?(this._initMSE(),this._initSimpleMSE(),super._initMediaElement(e,!0)):super._initMediaElement(e,!1)}_shouldBeEnded(){let e=this._lastSegmentAppended;if(!e||!e.isFinalSegment())return!1;if(!z)return super._shouldBeEnded();if(super._shouldBeEnded())return!0;if(!this.getMediaElement())return!1;let t=this._duration;return this._stallDetected&&null!==t&&this._getMediaElementPosition()>=t-600}_handleSeekChange(e,t){super._handleSeekChange(e,t),this._playlistSegmentRetriever&&(this._logger.debug("Explicitly updating playlist segment retriever, as seek requested."),this._playlistSegmentRetriever.update(),this._findSegmentAndAppendToMSE())}_performSeek(e,t){return this._mse&&!r.TimeRange.rangesContainTime(e,this._mse.getBuffered())&&(this._logger.debug("Seeking to an unbuffered area."),this._initSimpleMSE()),super._performSeek(e,t)}_kill(){this._simpleMSE&&(this._logger.debug("Killing SimpleMSE."),this._simpleMSE.kill(),this._simpleMSE=null),this._mse&&(this._logger.debug("Killing MSE."),this._mse.kill(),this._mse=null),this._playlistSegmentRetriever&&(this._logger.debug("Killing playlist segment retriever."),this._playlistSegmentRetriever.kill(),this._playlistSegmentRetriever=null),this._disposePlaylist(),super._kill()}_disposePlaylist(){this._playlistUpdateJob&&(this._logger.debug("Aborting playlist retrieve job."),this._playlistUpdateJob.abort(),this._playlistUpdateJob=null),this._playlistUpdateTimer&&(window.clearTimeout(this._playlistUpdateTimer),this._playlistUpdateTimer=null),this._playlistUpdateEventHandle&&(this._playlistUpdateEventHandle.remove(),this._playlistUpdateEventHandle=null),this._playlist=null}_initMSE(){if(!this._transmuxerAndMimeType)throw Error("Transmuxer should have been configured.");let e=this._mse=new w(this._transmuxerAndMimeType.mimeType,this._logger);e.whenInitialized().then(()=>{this._duration&&e.updateDuration(this._duration).catch(e=>{this._logger.warn("Error updating MSE duration.",e)})}).catch(e=>{e!==E&&(this._logger.error("Error during mse initialization.",e),this._triggerError(new U(e)))})}_initSimpleMSE(){if(!this._mse)throw Error("MSE should exist.");this._simpleMSE&&this._simpleMSE.kill(),this._lastSegmentAppended=null;let e=this._simpleMSE=new A(this._mse,()=>this._getSegmentDataToAppendNext(),()=>this._getMediaElementPosition(),e=>{this._triggerError(new T(e))},this._logger);e.onAppendQueued.subscribe(this._onSegmentAppendQueued.dispatch),e.onAppendEnd.subscribe(e=>{if(z){let e=this.getMediaElement();e&&this._isMediaElementPaused(e)&&e.ended&&this.isActuallyPlaying()&&(this._logger.debug("Calling play() on media element because we just appended something and should be playing."),this._callMediaElementPlay(e))}this._onSegmentAppendEnd.dispatch(e)}),e.start()}_getMediaElementPosition(){let e=this.getMediaElement();if(!e)throw Error("No media element.");return 1e3*e.currentTime}_whenPlaylistRetrieved(){let e=this._playlist;if(!e)throw Error("Playlist should have been retrieved.");if(this._playlistUpdateEventHandle=e.onUpdated.subscribe(()=>{this._updateLocalDurationsFromPlaylist(),this._handleDurationChange(),this._schedulePlaylistUpdate()}),this._initialPlaylistRetrieveCompleted){let t=F(e);if(this._playlistDuration<t){this._logger.error("The duration from the new playlist was less than the previous one."),this._triggerError(new L("The duration from the new playlist was less than the previous one.",{oldDuration:this._playlistDuration,newDuration:t}));return}}if(!this._transmuxerAndMimeType)throw Error("Transmuxer should have been configured.");if(this._playlistSegmentRetriever)this._logger.debug("Switching playlist for playlist segment retriever."),this._playlistSegmentRetriever.switchPlaylist(e);else{let t=this._maxBufferLength;if(null===t)throw Error("maxBufferLength should have been initiaized by now.");this._logger.debug("Creating playlist segment retriever.");let r=this._cacheSize;if(null===r)throw Error("cacheSize should be set.");let n=new i.PlaylistSegmentRetriever({playlist:e,getPosition:()=>this.getPosition(),maxBufferLength:t,cacheSize:r,transmuxer:this._transmuxerAndMimeType.transmuxer,logger:this._logger});n.onSegmentRequestQueued.subscribe(this._onSegmentRequestQueued.dispatch),n.onSegmentRequestStart.subscribe(this._onSegmentRequestStart.dispatch),n.onSegmentRetrieved.subscribe(this._onSegmentRetrieved.dispatch),n.onSegmentRequestFailed.subscribe(this._onSegmentRequestFailed.dispatch),this._playlistSegmentRetriever=n,n.onError.subscribe(e=>{this._logger.error("Error from playlist segment retriever.",e),e instanceof i.retrievalErrors.RetrievalError?this._triggerError(new x(e)):this._triggerError(new q("Unexpected error when trying to retrieve segment.",e))}),n.onSegmentDataRetrieveStarted.subscribe(({segment:e})=>{this._logger.debug("Segment retrieve started.",e.getEventRepresentation()),this._findSegmentAndAppendToMSE(),this._updateLocalDurationsFromPlaylist(),this._handleDurationChange(),this._onSegmentReady.dispatch({segment:e.getEventRepresentation()})})}e.hasEnded()||this._schedulePlaylistUpdate(),this._updateLocalDurationsFromPlaylist(),this._update(()=>{this._handleDurationChange(),this._initialPlaylistRetrieveCompleted=!0})}_schedulePlaylistUpdate(){let e=this._playlist;if(!e)throw Error("Playlist should exist.");if(this._playlistUpdateJob&&!this._playlistUpdateJob.hasCompleted()||(this._playlistUpdateTimer&&(window.clearTimeout(this._playlistUpdateTimer),this._playlistUpdateTimer=null),e.hasEnded()))return;let t=this.isPlaying()?e.getDuration()-this.getPosition()-1e4:1/0,r=e.getExpireTime(),n=r?N()-r:1/0,s=Math.max(Math.max(0,this._earliestAllowedNextUpdateTime-N()),Math.min(t,n,e.getType()===i.PlaylistType.EVENT?1e4:1/0));s<1/0&&(this._earliestAllowedNextUpdateTime=N()+2e3,this._playlistUpdateTimer=window.setTimeout(()=>{this._playlistUpdateTimer=null,(this._playlistUpdateJob=e.update()).onError(e=>{e!==B&&(this._handlePlaylistUpdateError(e),this._schedulePlaylistUpdate())})},s))}_updateLocalDurationsFromPlaylist(){let e=this._playlist;if(!e)throw Error("Missing playlist.");let t=this._duration=F(e),r=this._mse;r&&r.whenInitialized().then(()=>r.updateDuration(t)).catch(e=>{this._logger.warn("Error updating MSE duration.",e)}),this._playlistDuration=e.getDuration()}_findSegmentAndAppendToMSE(){let e=this._simpleMSE;if(e&&e.waitingForSegmentData()){let t=this._getSegmentDataToAppendNext();t&&(this._logger.debug("Providing segment to SimpleMSE.",t.eventRepresentation),e.provideNextSegmentData(t))}}_setPlaylist(e){if(this._playlist)throw Error("Playlist already exists.");this._playlist=e,this._playlistUpdateJob=this._playlist.update(),this._playlistUpdateJob.onCompletion(()=>{this._logger.debug("Playlist retrieved."),this._whenPlaylistRetrieved()}),this._playlistUpdateJob.onError(e=>{e!==B&&this._handlePlaylistUpdateError(e)})}_handlePlaylistUpdateError(e){this._logger.error("Error when retrieving playlist.",e),e instanceof i.retrievalErrors.RetrievalError?this._triggerError(new x(e)):this._triggerError(new q("Unexpected error when retrieving playlist.",e))}_getSegmentDataToAppendNext(){let e=this._lastSegmentAppended;this._logger.debug("Looking for segment to append next.",!!e);let t=this._playlistSegmentRetriever;if(!t)return this._logger.debug("No segment retriever."),null;if(e){let t=this._getSubsequentSegment(e);if(!t)return this._logger.debug("No segment found."),e.isFinalSegment()&&(this._logger.debug("The last segment we appended was the last one in the stream. Signalling EOS."),this._signalEOS()),null;let{segment:r}=t;return this._logger.debug("Found segment.",r.getEventRepresentation()),this._lastSegmentAppended=r,{data:t.dataRetrieveJob,startTime:r.getTimeRange().start,eventRepresentation:r.getEventRepresentation()}}{let e=this.getPosition(),r=I(t.getSegmentsWithData(),t=>t.segment.getTimeRange().containsTime(e));if(!r)return this._logger.debug("No segment found.",e),null;let{segment:i,dataRetrieveJob:n}=r,s=e-i.getTimeRange().start;if(!this.getMediaElement())throw Error("Media element should exist.");let o={data:n,startTime:i.getTimeRange().start,eventRepresentation:i.getEventRepresentation()};if(!i.isFinalSegment()){let e=i.getTimeRange().duration-s;for(;e<1e3;){let t=this._getSubsequentSegment(i);if(!t)return this._logger.debug("Not enough segments to cover min append duration.",e),null;t.segment.isFinalSegment()?e=1/0:e+=t.segment.getTimeRange().duration}}return this._logger.debug("Found initial segment.",i.getEventRepresentation()),this._lastSegmentAppended=i,o}}_getSubsequentSegment(e){let t=this._playlistSegmentRetriever;if(!t)return this._logger.debug("No segment retriever."),null;let r=t.getSegmentsWithData(),i=r[r.map(e=>e.segment.getSequenceNumber()).indexOf(e.getSequenceNumber())+1];return i&&i.segment.getTimeRange().start===e.getTimeRange().end?i:null}_signalEOS(){this._logger.debug("Signalling EOS."),this._simpleMSE&&(this._simpleMSE.kill(),this._logger.debug("Killed SimpleMSE."),this._simpleMSE=null);let e=this._mse;e&&!e.eosSignalled()&&e.signalEOS().catch(t=>{if(e===this._mse){if("InvalidStateError"===t.name){this._logger.error("InvalidStateError occurred when signalling EOS.",t);return}this._logger.error("Error occurred when signalling EOS.",t),this._triggerError(new T(t))}})}}(e=t||(t={})).AppendError=T,e.InitializeError=U,e.PlaylistUpdateError=L,e.NoTransmuxerError=D,e.RetrievalError=x;let J="31.1.0",K=2227})(),o})(),e.exports=i(r(18471),r(81789),r(37966))},42012:function(e,t,r){var i;"undefined"!=typeof self&&self,i=e=>(()=>{"use strict";var t=[,t=>{t.exports=e}],r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};i.r(n),i.d(n,{buildNumber:()=>_,buildWebm:()=>f,parseOpusHead:()=>g,setOutputGain:()=>c,version:()=>m});var s=i(1);let{combine:o,numberToUint8Array:a,createVintBuffer:l}=s.helpers.arrayBuffer;function u(e,t){return o([a(e),l(t.byteLength),t])}let{combine:h,numberToUint8Array:d}=s.helpers.arrayBuffer,p=[10,20,40,60,10,20,40,60,10,20,40,60,10,20,10,20,2.5,5,10,20,2.5,5,10,20,2.5,5,10,20,2.5,5,10,20];function g(e){let t,r,i;if(!e.first)throw Error("OpusHead is always in the first packet.");let n=new DataView(e.data.buffer),s=n.getUint8(9),o=n.getUint8(18);if(o>0){t=n.getUint8(18),r=n.getUint8(19),i=[];for(let e=0;e<s;e++)i.push(n.getUint8(20+e))}return{version:n.getUint8(8),channelCount:s,preSkip:n.getUint16(10,!0),inputSampleRate:n.getUint32(12,!0),outputGain:.00390625*n.getInt16(16,!0),channelMapFamily:o,streamCount:t,twoChannelStreamCount:r,channelMappingTable:i}}function c(e,t){if(t>=128||t<-128)throw Error("outputGainOverride invalid. It must be >= -128 and < 128.");g(e),new DataView(e.data.buffer).setInt16(16,Math.round(256*t),!0)}function f(e){let t=e[0];if(!t||!t.first)throw Error("Missing start of stream.");let r=e.slice(2),i=g(t),n=0,s=r.map(e=>{let t=new Uint8Array(4);t[0]=129,new DataView(t.buffer).setInt16(1,n),t[3]=128;let r=function(e){let t=3&e[0];return 0===t?1:3!==t?2:63&e[1]}(e.data);return n+=r*function(e){let t=e[0]>>>3&31;if(t>=p.length)throw Error("Invalid configuration.");return p[t]}(e.data),u(163,h([t,e.data]))});return{initData:h([u(440786851,h([u(17030,d(1)),u(17143,d(1)),u(17138,d(4)),u(17139,d(8)),u(17026,new Uint8Array([119,101,98,109])),u(17031,d(1)),u(17029,d(2))])),u(408125543,u(357149030,u(17545,(()=>{let e=new Uint8Array(8);return new DataView(e.buffer).setFloat64(0,n),e})()))),u(374648427,u(174,h([u(215,d(1)),u(29637,d(1)),u(156,d(0)),u(134,new Uint8Array([65,95,79,80,85,83])),u(22186,d(i.preSkip/48e3*1e9)),u(22203,new Uint8Array([4,196,180,0])),u(131,d(2)),u(225,h([u(159,d(i.channelCount)),u(181,new Uint8Array([64,231,112,0,0,0,0,0]))])),u(25506,t.data)])))]),data:u(524531317,(()=>{let e=[u(231,d(0))];return e.push(...s),h(e)})())}}let m="31.1.0",_=2227;return n})(),e.exports=i(r(18471))},61308:function(e,t,r){var i;"undefined"!=typeof self&&self,i=e=>(()=>{"use strict";var t=[,t=>{t.exports=e}],r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};i.r(n),i.d(n,{ChecksumFailedError:()=>l,IncompletePageError:()=>c,NoSegmentsInPageError:()=>g,OggParserError:()=>a,PageFromDifferentBitstreamError:()=>u,PageSequenceNumberDidNotIncrementError:()=>h,UnexpectedBOSError:()=>d,UnexpectedEOSError:()=>p,buildNumber:()=>R,parsePage:()=>S,retrievePackets:()=>E,retrievePages:()=>b,version:()=>w});var s=i(1);let o=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]);class a{constructor(e){this._msg=e}getMsg(){return this._msg}}class l extends a{}class u extends a{}class h extends a{}class d extends a{}class p extends a{}class g extends a{}class c extends a{}let f=s.helpers.arrayBuffer.combine,m=new Uint8Array([79,103,103,83]),_=new Uint8Array([0,0,0,0]);function y(e,t,r=1){if(t<0||t+r>e.byteLength)throw Error(`extract() out of bounds. ${t} ${r} ${e.byteLength}`);return e.slice(t,t+r)}function v(e,t=!0){return new DataView(e).getUint32(0,t)}function b(e){let t=e.buffer,r=[],i=e.byteOffset,n=!0;for(;i<e.byteOffset+e.byteLength;){let e=new DataView(t,i);try{let t=S(e);r.push(t),i+=t.entirePage.byteLength}catch(e){if(e instanceof c){n=!1;break}throw e}}return{pages:r,eos:n}}function S(e){var t;let r;let i=new Uint8Array(e.buffer,e.byteOffset),n=i.byteLength;if(n<27)throw new c("Incomplete page.");let s=y(i,26);if(n<27+s[0])throw new c("Incomplete page.");let a=y(i,27,s[0]),u={version:y(i,4),type:y(i,5),granulePosition:y(i,6,8),bitstreamSerialNumber:y(i,14,4),pageSequenceNumber:y(i,18,4),checksum:y(i,22,4),pageSegments:s,segmentTable:a},h=[],d=27+s[0];if(a.forEach(e=>{if(n<d+e)throw new c("Incomplete page.");h.push(y(i,d,e)),d+=e}),!h.length)throw new g("No segments.");if(t=[m,u.version,u.type,u.granulePosition,u.bitstreamSerialNumber,u.pageSequenceNumber,_,s,a,...h],r=0,t.forEach(e=>{for(let t=0;t<e.length;t++)r=r<<8^o[r>>24&255^e[t]]}),r>>>0!==v(u.checksum.buffer))throw new l("Checksum failed.");return{header:u,segments:h,entirePage:y(i,0,d)}}function E(e){if(!e.length)return[];let t=v(e[0].header.bitstreamSerialNumber.buffer),r=-1,i=null,n=[];return e.forEach((s,o)=>{if(v(s.header.bitstreamSerialNumber.buffer)!==t)throw new u("Got a page from a different bitstream.");let a=v(s.header.pageSequenceNumber.buffer);if(a<=r)throw new h("Page sequence number was not greater than the previous one.");let l=a!==r+1;r=a;let g=s.header.type[0],c=!!(1&g),m=!!(2&g);if(m&&o>0)throw new d("Got BOS on a page which is not the first.");let _=!!(4&g);if(_&&o!==e.length-1)throw new p("Got EOS on a page which is not the last.");let y=0;l&&(i=null);let b=s.segments.length;s.segments.forEach((e,t)=>{if(i?i.data=f([i.data,e]):!(c&&0===t)&&(i={granulePosition:null,pageSequenceNumber:r,packetOffset:y,discontinuity:l&&0===y,first:m&&0===y,last:!1,data:e},y++),i&&e.byteLength<255){let e=t===b-1;e&&(i.granulePosition=v(s.header.granulePosition.buffer)),i.last=_&&e,n.push(i),i=null}})}),n}let w="31.1.0",R=2227;return n})(),e.exports=i(r(18471))},94456:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t)=>(()=>{"use strict";var r,i,n=[,t=>{t.exports=e},e=>{e.exports=t}],s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return n[e](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};o.r(a),o.d(a,{PlaylistHLS:()=>U,buildNumber:()=>D,version:()=>x});var l=o(1),u=o(2);let{UnacceptableResponseStatusCodeError:h,PlaylistParseError:d,UnsupportedEncryptionError:p}=u.retrievalErrors,g=l.helpers.abortableJob.AbortableJob,c=l.helpers.deferred.buildDeferred,f=l.helpers.cache.buildCache,{retry:m,buildExponentialDelayCalculator:_}=l.helpers.retry,{Promise:y,find:v,url:b}=l.helpers,{prefixLogger:S,noOpLogger:E}=l.logger,w=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(MAP):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT(INF): *(\d+(?:\.\d+)?)(?:,(.*))?)|(?:(?!#)()(\S.+))|(?:#EXT-X-(BYTERANGE): *(\d+(?:@\d+(?:\.\d+)?)?)|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.+))|(?:#EXT-X-(VERSION):(\d+))|(?:(#)(.*):(.*))|(?:(#)(.*)))(?:.*)\r?\n?/g,R=/(.+?)=(.+?)(?:,|$)/g,P=/^\d*(\.\d+)?$/;(r=i||(i={}))[r.NONE=0]="NONE",r[r.AES_128=1]="AES_128",r[r.SAMPLE_AES=2]="SAMPLE_AES";let M=e=>new u.Segment(e);function A(e){return!(e>=400&&e<500)}function T(e){let t;let r={};for(R.lastIndex=0;null!==(t=R.exec(e));){var i;let e=t[1].trim().toLowerCase(),n=0===(i=t[2].trim()).indexOf('"')&&i.lastIndexOf('"')===i.length-1?i.slice(1,-1):i;r[e]=n}return r}class U extends u.Playlist{constructor({url:e,playlistLoader:t,segmentLoader:r,keyLoader:i,segmentFormat:n,logger:s=E,delayCalculator:o=_(),keyDelayCalculator:a=_(),segmentDelayCalculator:d,isPlaylistResponseCodeAcceptable:p=e=>200===e,isPlaylistResponseCodeRetryable:v=A,isSegmentResponseCodeAcceptable:b=e=>200===e,isSegmentResponseCodeRetryable:w=A,isKeyResponseCodeAcceptable:R=e=>200===e,isKeyResponseCodeRetryable:P=A,segmentFactory:T=M,getTime:U=l.helpers.time.now}){super(),this._keyRetrievalJobsCache=f(),this._initDataRetrievalJobsCache=f(),this._data=null,this._lastUpdateTime=null,this._playlistEventRepresentation=null,this._logger=S(s,"PlaylistHLS"),this._url=e,this._playlistLoader=t,this._segmentLoader=r,this._keyLoader=i||null,this._segmentFormat=n,this._keyDelayCalculator=a,this._isPlaylistResponseCodeAcceptable=p,this._isPlaylistResponseCodeRetryable=v,this._isSegmentResponseCodeAcceptable=b,this._isSegmentResponseCodeRetryable=w,this._isKeyOrInitDataResponseCodeAcceptable=R,this._isKeyOrInitDataResponseCodeRetryable=P,this._segmentDelayCalculator=d,this._segmentFactory=T,this._downloadAbortableJob=new g(()=>{let t=l.helpers.deferred.buildDeferred(),{cancel:r}=m(o,({scheduleRetry:r})=>{let i=new u.events.Playlist(e);this._onPlaylistRequestQueued.dispatch({playlist:i});let n=this._playlistLoader.request({url:e});return n.onRequestStart(()=>{this._onPlaylistRequestStart.dispatch({playlist:i})}),this._logger.debug("Requesting playlist.",e),n.onResponseReceived(n=>{if(!n){this._logger.warn("Playlist request timed out.",e),this._onPlaylistRequestFailed.dispatch({playlist:i,statusCode:null}),r();return}let s=n.statusCode;if(this._isPlaylistResponseCodeAcceptable(s)){let o=n.getData();if(!o){this._logger.warn("Playlist response contained no data.",e,s),this._onPlaylistRequestFailed.dispatch({playlist:i,statusCode:s}),r();return}this._logger.debug("Got playlist response.",e,s),this._onPlaylistRetrieved.dispatch({playlist:i,statusCode:s}),t.resolve({playlistContent:o,eventRepresentation:i});return}if(!this._isPlaylistResponseCodeRetryable(s)){this._logger.debug("Playlist response code was not acceptable.",e,s),this._onPlaylistRequestFailed.dispatch({playlist:i,statusCode:s}),t.reject(new h(s));return}this._logger.debug("Playlist response code was not acceptable. Will retry.",e,s),this._onPlaylistRequestFailed.dispatch({playlist:i,statusCode:s}),r()}),n.onError(i=>{if(i instanceof l.loaderErrors.LoaderError){this._logger.warn("Error from loader. Will retry",e,i),r();return}t.reject(i)}),{onCancel:()=>{this._logger.debug("Aborting playlist request.",e),n.hasCompleted()||n.abort(),this._onPlaylistRequestFailed.dispatch({playlist:i,aborted:!0})}}},{onNoMoreRetries:()=>t.reject(Error("No more retries for requesting playlist."))});return{result:t.promise,abort:()=>r()}}),this._updateJob=new g(()=>{if(this._data&&this._data.ended)return{result:y.resolve(void 0)};let e=c(),t=this._downloadAbortableJob.run();return t.onCompletion(({playlistContent:t,eventRepresentation:r})=>{this._lastUpdateTime=U(),this._onPlaylistParseStart.dispatch({playlist:r});try{this._data=this._parsePlaylist(t)}catch(r){this._logger.error("Error when parsing playlist.",r,t),e.reject(r);return}this._playlistEventRepresentation=r,this._onPlaylistParseEnd.dispatch({playlist:r}),e.resolve(void 0)}),t.onError(e.reject),{result:e.promise,abort:()=>t.abort()}})}hasInitialUpdateCompleted(){return!!this._data}getType(){if(!this._data)throw Error("Not loaded yet.");return this._data.type}getExpireTime(){let e=this._data,t=this._lastUpdateTime;return e&&e.type===u.PlaylistType.LIVE&&null!==t?t+e.segments.reduce((e,t)=>e+t.timeRange.duration,0)/2:null}hasEnded(){if(!this._data)throw Error("Not loaded yet.");return this._data.ended}getCompleteDuration(){return this._data&&this._data.ended?this._data.totalDuration:null}getDuration(){if(!this._data)throw Error("Not loaded yet.");return this._data.totalDuration}getTargetDuration(){if(!this._data)throw Error("Not loaded yet.");return this._data.targetDuration}getFirstSegmentIndex(){if(!this._data)throw Error("Not loaded yet.");return this._data.mediaSequence}getSegmentCount(){if(!this._data)throw Error("Not loaded yet.");return this._data.segments.length}getSegmentIndexContainingTime(e){let t=this._data;if(!t)throw Error("Not loaded yet.");let r=v(t.segments,t=>t.timeRange.containsTime(e));return r?t.mediaSequence+t.segments.indexOf(r):null}_update(){return this._updateJob.run()}_getSegment(e){let t=this._data;if(!t)throw Error("Not loaded yet.");let r=t.segments[e-t.mediaSequence];return new g(()=>{let t=r.encryptionData,i=this._playlistEventRepresentation;if(!i)throw Error("Playlist event representation should exist.");let n=this._buildEncryptionConfig(t,e),s=r.initDataUrl?this._retrieveInitData(r.initDataUrl):null;return{result:n.whenComplete().then(t=>{let n=n=>this._segmentFactory({url:r.url,sequenceNumber:e,playlist:this,timeRange:r.timeRange,format:this._segmentFormat,loader:this._segmentLoader,playlistEventRepresentation:i,logger:this._logger,delayCalculator:this._segmentDelayCalculator,isResponseCodeAcceptable:this._isSegmentResponseCodeAcceptable,isResponseCodeRetryable:this._isSegmentResponseCodeRetryable,encryptionConfig:t,initData:n});return s?s.whenComplete().then(e=>n(e)):n(void 0)}),abort:()=>{n.abort(),s&&s.abort()}}}).run()}_buildEncryptionConfig(e,t){return new g(()=>{if(e.method===i.NONE)return{result:y.resolve(void 0)};if(e.method!==i.AES_128)return this._logger.error("Unsupported encryption method.",e.method),{result:y.reject(new p)};if(!this._keyLoader)return{result:y.reject(Error("Encryption method not supported as no key loader provided."))};let r=this._retrieveKey(e.keyUrl);return{result:r.whenComplete().then(r=>({cipher:"AES-CBC",key:r,iv:e.iv||function(e){let t=new Uint8Array(16);for(let r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t)})),abort:()=>r.abort()}},{storeResult:!0}).run()}_retrieveKey(e){let t=this._keyLoader;if(!t)throw Error("No key loader.");let r=this._playlistEventRepresentation;if(!r)throw Error("Playlist event representation should exist.");let i=new u.events.Key(r,e);return this._retrieveKeyOrInitData({url:e,loader:t,cache:this._keyRetrievalJobsCache,onRequestQueued:()=>this._onKeyRequestQueued.dispatch({key:i}),onRequestStart:()=>this._onKeyRequestStart.dispatch({key:i}),onRequestTimedOut:()=>{this._onKeyRequestFailed.dispatch({key:i,statusCode:null})},onRequestFailed:e=>{this._onKeyRequestFailed.dispatch({key:i,statusCode:e})},onRequestAborted:()=>{this._onKeyRequestFailed.dispatch({key:i,aborted:!0})},onRetrieved:e=>{this._onKeyRetrieved.dispatch({key:i,statusCode:e})},type:"key"})}_retrieveInitData(e){let t=this._playlistEventRepresentation;if(!t)throw Error("Playlist event representation should exist.");let r=new u.events.InitData(t,e);return this._retrieveKeyOrInitData({url:e,loader:this._segmentLoader,cache:this._initDataRetrievalJobsCache,onRequestQueued:()=>this._onInitDataRequestQueued.dispatch({initData:r}),onRequestStart:()=>this._onInitDataRequestStart.dispatch({initData:r}),onRequestTimedOut:()=>{this._onInitDataRequestFailed.dispatch({initData:r,statusCode:null})},onRequestFailed:e=>{this._onInitDataRequestFailed.dispatch({initData:r,statusCode:e})},onRequestAborted:()=>{this._onInitDataRequestFailed.dispatch({initData:r,aborted:!0})},onRetrieved:e=>{this._onInitDataRetrieved.dispatch({initData:r,statusCode:e})},type:"init data"})}_retrieveKeyOrInitData({url:e,loader:t,cache:r,onRequestQueued:i,onRequestStart:n,onRequestTimedOut:s,onRequestFailed:o,onRequestAborted:a,onRetrieved:u,type:d}){let p=r.get(e);return p?this._logger.debug(`${d} retrieval already in progress.`,e):(p=new g(()=>{let r=l.helpers.deferred.buildDeferred(),{cancel:p}=m(this._keyDelayCalculator,({scheduleRetry:p})=>{i();let g=t.request({url:e});return g.onRequestStart(n),this._logger.debug(`Retrieving ${d}.`,e),g.onResponseReceived(t=>{if(!t){this._logger.warn(`${d} request timed out.`,e),s(),p();return}let i=t.statusCode;if(this._isKeyOrInitDataResponseCodeAcceptable(i)){let n=t.getData();if(!n){this._logger.warn(`${d} response contained no data.`,e,i),o(i),p();return}this._logger.debug(`Got ${d} response.`,e,i),u(i),r.resolve(new Uint8Array(n));return}if(!this._isKeyOrInitDataResponseCodeRetryable(i)){this._logger.warn(`${d} response code was not acceptable.`,e,i),o(i),r.reject(new h(i));return}this._logger.warn(`${d} response code was not acceptable. Will retry.`,e,i),o(i),p()}),g.onError(t=>{if(t instanceof l.loaderErrors.LoaderError){this._logger.warn("Error from loader. Will retry",e,t),p();return}r.reject(t)}),{onCancel:()=>{this._logger.debug(`Aborting ${d} request.`,e),g.hasCompleted()||g.abort(),a()}}},{onNoMoreRetries:()=>r.reject(Error(`No more retries for requesting ${d}.`))});return{result:r.promise,abort:()=>p()}},{storeResult:!0}),r.set(e,p)),p.run()}_parsePlaylist(e){let t;let r=this._data,n={version:null,type:u.PlaylistType.LIVE,mediaSequence:null,targetDuration:null,totalDuration:0,ended:!1},s=[],o={method:i.NONE},a=null,h=null;w.lastIndex=0;let p=0,g=!1;for(;null!==(t=w.exec(e));){let[e,...r]=t.filter((e,t)=>0!==t&&void 0!==e).map((e,t)=>0===t?e.toLowerCase():e);if(0===p){if("extm3u"!==e)throw new d("First line did not contain EXTM3U tag.")}else{if(!g)switch(e){case"playlist-type":if(n.type!==u.PlaylistType.LIVE)throw new d("Already have playlist type.");switch(r[0].toLowerCase()){case"vod":n.type=u.PlaylistType.VOD;break;case"event":n.type=u.PlaylistType.EVENT;break;default:throw new d("Invalid playlist type.")}break;case"media-sequence":{if(null!==n.mediaSequence)throw new d("Already have media sequence number.");let e=parseInt(r[0],10);if(e+""!==r[0])throw new d("Invalid media sequence number.");n.mediaSequence=e;break}case"targetduration":{if(null!==n.targetDuration)throw new d("Already have target duration.");let e=parseInt(r[0],10);if(e+""!==r[0]||e<0)throw new d("Invalid target duration.");n.targetDuration=1e3*e;break}case"version":{if(null!==n.version)throw new d("Already have version.");let e=parseInt(r[0],10);if(e+""!==r[0])throw new d("Invalid version.");if(e<3)throw new d("HLS version must be 3 or above.");n.version=e;break}default:g=!0}if(g)switch(e){case"key":{let e=T(r[0]),t="method"in e?e.method.toLowerCase():null,n="uri"in e?b.buildAbsoluteUrl(this._url,e.uri):null,s="iv"in e?function(e){0===e.indexOf("0x")&&(e=e.substr(2));let t=new Uint16Array(8);if(e.length%4!=0)throw new d("Failed to parse IV (length is not multiple of 4).");for(let r=0;r<e.length;r+=4){let i=parseInt(e.substr(r,4),16);if(isNaN(i))throw new d("Failed to parse hex number in IV string.");t[r/4]=i}return new Uint8Array(t)}(e.iv):null;if(!t)throw new d("Missing encryption method.");if(!n&&"none"!==t)throw new d("Missing key url.");switch(t){case"none":if(null!==n)throw new d("Key url not allowed.");if(null!==s)throw new d("IV not allowed.");o={method:i.NONE};break;case"aes-128":if(!n)throw new d("Key url required.");o={method:i.AES_128,keyUrl:n,iv:s};break;case"sample-aes":if(!n)throw new d("Key url required.");o={method:i.SAMPLE_AES,keyUrl:n,iv:s};break;default:throw new d("Unknown encryption method.")}break}case"map":{let e=T(r[0]);if(!("uri"in e))throw new d("URI missing from EXT-X-MAP tag.");if("byterange"in e)throw new d("BYTERANGE in EXT-X-MAP tag is currently unsupported.");a=e.uri?b.buildAbsoluteUrl(this._url,e.uri):null;break}case"inf":if(!r[0].match(P))throw new d("Invalid segment duration.");h=1e3*parseFloat(r[0]);break;case"":{if(n.ended)throw new d("Already received ENDLIST tag.");if(null===h)throw new d("Not received segment duration.");let e=b.buildAbsoluteUrl(this._url,r[0]);s.push({url:e,timeRange:new l.TimeRange(n.totalDuration,h),initDataUrl:a,encryptionData:o}),n.totalDuration+=h,h=null;break}case"endlist":if(n.ended)throw new d("Already had ENDLIST tag.");n.ended=!0;break;default:this._logger.warn("Unable to parse playlist line.",e)}}p++}let{version:c,type:f,targetDuration:m,ended:_}=n,{mediaSequence:y,totalDuration:v}=n;if(null===c)throw new d("Missing version.");if(null===m)throw new d("Missing target duration.");if(_&&f===u.PlaylistType.LIVE)throw new d("Cannot be ended if type is LIVE.");if(!_&&f===u.PlaylistType.VOD)throw new d("Must be ended if type is VOD.");if(null===y&&(y=0),r){if(r.type!==f)throw new d("Playlist type has changed since last update.");if(r.type===u.PlaylistType.EVENT&&y!==r.mediaSequence)throw new d("Media sequence number has changed. Not valid for EVENT playlist.");let e=r.segments[y-r.mediaSequence];if(!e)throw new d("Tracking lost. The last segment of the previous playlist is no longer in the new one.");let t=e.timeRange.start;s.forEach(e=>{let r=e.timeRange;e.timeRange=new l.TimeRange(r.start+t,r.duration)}),v+=t}return{version:c,type:f,mediaSequence:y,targetDuration:m,totalDuration:v,ended:_,segments:s}}}let x="31.1.0",D=2227;return a})(),e.exports=i(r(18471),r(81789))},6661:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t,r,i)=>(()=>{"use strict";var n=[,t=>{t.exports=e},e=>{e.exports=t},e=>{e.exports=r},e=>{e.exports=i}],s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return n[e](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};o.r(a),o.d(a,{HLSJSPlayer:()=>u.HLSJSPlayer,HLSJSPlayerController:()=>g,buildNumber:()=>v,requestSupportedDRMProtocols:()=>_,version:()=>y});var l=o(1),u=o(2),h=o(3),d=o(4);class p{constructor(){this._urlMap=void 0}mapUrl(e){if(!this._urlMap)return e;let t=this._getKey(e);return this._urlMap[t]||e}updateWithPlaylist(e){let t=e.split("\n"),r={};for(let e=0;e<t.length;++e){let i;let n=t[e].trim();if(0!==n.length){if(0===n.lastIndexOf('#EXT-X-MAP:URI="',0)){let e=n.indexOf('"',16);i=n.substring(16,e)}else{if("#"===n[0])continue;i=n}r[this._getKey(i)]=i}}this._urlMap=r}_getKey(e){return e.split("?")[0]}}class g extends l.BaseController{constructor(e,t,r){super(),this._mediaElementManager=e,this._supportedDrmProtocols=t,this._licenseUrl=r,this.name="MaestroHLSJS"}isRenditionSupported(e){return -1!==["hls","encrypted-hls",...this._supportedDrmProtocols].indexOf(e.scProtocol)&&u.HLSJSPlayer.isFormatSupported(e.maestroSegmentFormat||{})}buildPlayer(e){return new c(e,this._mediaElementManager,this._licenseUrl)}}class c{constructor(e,t,r){var i;this._mediaElementManager=t,this._licenseUrl=r,this._loader=d.stringLoader,this._urlMapper=new p;let{logger:n,playerId:s,urlAndRendition:o,reportError:a,fadeOnPauseAndPlay:l,fadeOnSeek:g,releaseControl:c,streamUrlExpires:f,getNewUrl:m,seekStrategy:_,applicationId:y}=e,v={name:s,logger:n,seekStrategy:_,fadeSupportEnabled:l||g,defaultFadeDuration:l?void 0:0,defaultSeekFadeInDuration:g?void 0:0,defaultSeekFadeOutDuration:g?void 0:0,registerListeners:({onError:e,onChange:t})=>{e.subscribe(e=>{if(f&&this._shouldFetchNewUrl(e)){let e=new h.helpers.abortableJob.AbortableJob(()=>{let e=h.helpers.deferred.buildDeferred();return m().whenComplete().then(t=>{t?(this._currentUrl=t,this._refetchPlaylist().then(()=>{e.resolve()})):(n.error("Could not get a new URL"),c({retry:!1}))}).catch(e=>{n.error("Unexpected error when trying to retrieve a new URL.",e),c({retry:!1})}),{result:e.promise}});this._refreshHandle=e.run(),this._refreshHandle.whenComplete().then(()=>{this._refreshHandle=void 0}).catch(()=>{this._refreshHandle=void 0});return}a(e.getCode())}),t.subscribe(({dead:e})=>{e&&c({retry:!1})})}};this._logger=n,this._applicationId=y,r&&(v.drmSystems={[u.DRMKeySystems.FAIRPLAY]:{licenseUrl:r+"/playback/fairplay",serverCertificateUrl:r+"/playback/fairplay"},[u.DRMKeySystems.WIDEVINE]:{licenseUrl:r+"/playback/widevine"},[u.DRMKeySystems.PLAYREADY]:{licenseUrl:r+"/playback/playready"}}),v.xhrSetup=(e,t)=>{if(this._refreshHandle)return this._refreshHandle.whenComplete().then(()=>this._xhrSetup(e,t));this._xhrSetup(e,t)};let b=o.url,S="cbc-encrypted-hls"===(i=o.rendition.scProtocol)||"ctr-encrypted-hls"===i,E=new u.HLSJSPlayer({url:b,drmProtected:S},v);this._player=E,this._currentUrl=b;let w=S&&h.helpers.browser.isFirefox();this._mediaElementManager.registerPlayer(E,()=>c({retry:!1}),w)}getPlayer(){return this._player}getUrl(){return this._currentUrl}_shouldFetchNewUrl(e){return!this._refreshHandle&&e instanceof u.HLSJSPlayerError&&"fragLoadError"===e.getData().details}_xhrSetup(e,t){if(e.readyState===e.UNSENT){let r=this._urlMapper.mapUrl(t);r!==t&&(this._logger.debug(`rewriting ${t} to ${r}`),e.open("GET",r,!0))}let r=new URL(t),i=r.pathname.endsWith(".m3u8")||r.origin===this._licenseUrl;this._applicationId&&i&&e.setRequestHeader("X-SC-Application-Id",this._applicationId)}_refetchPlaylist(){return this._loader.request({url:this._currentUrl}).getResponse().then(e=>{if(!e||200!==e.statusCode)return;let t=e.getData();t&&this._urlMapper.updateWithPlaylist(t)})}}let f=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'}]}];function m(e,t){try{return navigator.requestMediaKeySystemAccess(t.toString(),f).then(()=>{e[t]=!0}).catch(()=>{e[t]=!1})}catch(e){return h.helpers.Promise.reject(e)}}function _(){let e={};return h.helpers.Promise.all([m(e,u.DRMKeySystems.FAIRPLAY),m(e,u.DRMKeySystems.PLAYREADY),m(e,u.DRMKeySystems.WIDEVINE)]).then(()=>{let t=[];return(e[u.DRMKeySystems.PLAYREADY]||e[u.DRMKeySystems.WIDEVINE])&&t.push("ctr-encrypted-hls"),e[u.DRMKeySystems.FAIRPLAY]&&t.push("cbc-encrypted-hls"),t})}let y="24.1.3",v=1201;return a})(),e.exports=i(r(49680),r(14112),r(18471),r(92784))},72560:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t,r,i,n,s)=>(()=>{"use strict";var o=[,t=>{t.exports=e},e=>{e.exports=t},e=>{e.exports=r},e=>{e.exports=i},e=>{e.exports=n},e=>{e.exports=s}],a={};function l(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return o[e](r,r.exports,l),r.exports}l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};l.r(u),l.d(u,{HLSMSEPlayer:()=>f.HLSMSEPlayer,HLSMSEPlayerController:()=>y,buildNumber:()=>S,version:()=>b});var h=l(1),d=l(2),p=l(3),g=l(4),c=l(5),f=l(6);let m=/^[^?#]*/;function _(e){return e.match(m)[0]}class y extends h.BaseController{constructor(e){super(),this._mediaElementManager=e,this.name="MaestroHLSMSE"}isRenditionSupported(e){return -1!==["hls","encrypted-hls"].indexOf(e.scProtocol)&&f.HLSMSEPlayer.isFormatSupported(e.maestroSegmentFormat||{})}buildPlayer(e){return new v(e,this._mediaElementManager)}}class v{constructor(e,t){this._config=e,this._mediaElementManager=t,this._urlRefreshRetrieveHandle=null;let{logger:r,playerId:i,urlAndRendition:n,streamUrlExpires:s,reportError:o,fadeOnPauseAndPlay:a,fadeOnSeek:l,releaseControl:u,getNewUrl:h,seekStrategy:g}=e;this._currentUrl=n.url;let c=n.rendition.maestroSegmentFormat||{},m=this._buildPlaylist(n.url),y=this._player=new f.HLSMSEPlayer({playlist:m,segmentFormat:c},{name:i,mediaElement:null,fadeSupportEnabled:a||l,defaultFadeDuration:a?void 0:0,defaultSeekFadeInDuration:l?void 0:0,defaultSeekFadeOutDuration:l?void 0:0,logger:r,seekStrategy:g,registerListeners:({onError:e,onChange:t})=>{e.subscribe(e=>{if(s){if(e instanceof p.errors.URLUpdateError){r.error("URL refresh failed for some reason.",e),u({retry:!0});return}if(this._isErrorWhichShouldTriggerURLRefresh(e)){if(this._urlRefreshRetrieveHandle){r.debug("Got a 403 status code, but URL refresh already in progress.");return}r.info("Got a 403 status code. Peforming a URL refresh..."),(this._urlRefreshRetrieveHandle=h()).whenComplete().then(e=>{this._urlRefreshRetrieveHandle=null,e?_(e)!==_(this._currentUrl)?(r.warn("Got a new URL but the rendition did not match the original."),u({retry:!1})):(this._currentUrl=e,r.info("Got a new URL. Updating..."),y.switchPlaylist(this._buildPlaylist(e))):(r.warn("Could not get a new URL."),u({retry:!1}))}).catch(e=>{r.error("Unexpected error when trying to retrieve a new URL.",e),u({retry:!1})});return}}o(e.getCode()),d.HTML5PlayerController.errorQualifiesAbort(e)&&u({retry:!1})}),t.subscribe(({dead:e})=>{e&&(this._urlRefreshRetrieveHandle&&(this._urlRefreshRetrieveHandle.abort(),this._urlRefreshRetrieveHandle=null),u({retry:!1}))})}});this._mediaElementManager.registerPlayer(y,()=>u({retry:!1}))}getPlayer(){return this._player}getUrl(){return this._currentUrl}_buildPlaylist(e){let t=new g.ArrayBufferLoader({fetchEnabled:this._config.fetchEnabled});return new c.PlaylistHLS({url:e,playlistLoader:g.stringLoader,segmentLoader:t,keyLoader:t,segmentFormat:this._config.urlAndRendition.rendition.maestroSegmentFormat||{},logger:this._config.logger})}_isErrorWhichShouldTriggerURLRefresh(e){if(e instanceof f.errors.RetrievalError){let t=e.getCause();if(t instanceof f.retrievalErrors.UnacceptableResponseStatusCodeError)return 403===t.getStatusCode()}return!1}}let b="24.1.3",S=1201;return u})(),e.exports=i(r(49680),r(70677),r(18471),r(92784),r(94456),r(81141))},28715:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t)=>(()=>{var r=[,function(e){var t,r,i,n,s;t=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=s.parseURL(e);if(!n)throw Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var o=s.parseURL(t);if(!o)throw Error("Error trying to parse relative URL.");if(o.scheme)return i.alwaysNormalize?(o.path=s.normalizePath(o.path),s.buildURLFromParts(o)):t;var a=s.parseURL(e);if(!a)throw Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var l=r.exec(a.path);a.netLoc=l[1],a.path=l[2]}a.netLoc&&!a.path&&(a.path="/");var u={scheme:a.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=a.netLoc,"/"!==o.path[0])){if(o.path){var h=a.path,d=h.substring(0,h.lastIndexOf("/")+1)+o.path;u.path=s.normalizePath(d)}else u.path=a.path,o.params||(u.params=a.params,o.query||(u.query=a.query))}return null===u.path&&(u.path=i.alwaysNormalize?s.normalizePath(o.path):o.path),s.buildURLFromParts(u)},parseURL:function(e){var r=t.exec(e);return r?{scheme:r[1]||"",netLoc:r[2]||"",path:r[3]||"",params:r[4]||"",query:r[5]||"",fragment:r[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(n,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},t=>{"use strict";t.exports=e},e=>{"use strict";e.exports=t}],i={};function n(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return r[e].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";n.r(s),n.d(s,{StreamUrlRetriever:()=>l,buildNumber:()=>h,version:()=>u});var e=n(1),t=n(2),r=n(3);let i=/^([^;]+)(?:; codecs="([^,]+)(?:,(.+))?")?$/,o=new r.Limiter,a=[r.renditions.encryptedHlsMp3,r.renditions.hlsMp3,r.renditions.encryptedHlsOpus,r.renditions.hlsOpus,r.renditions.hlsAACHQ,r.renditions.encryptedHlsAACHQ,r.renditions.ctrEncryptedHlsAAC,r.renditions.cbcEncryptedHlsAAC,r.renditions.httpMp3,r.renditions.httpAACHQ];class l extends r.BaseStreamUrlRetriever{constructor({loader:e,trackId:t,trackAuthorization:r=null,secretToken:i=null,mediaPayload:n,clientId:s,requestAuthorization:o=null,excludedRenditions:a=[]}){if(super(),this.name="MediaPayload",!e)throw Error("loader required.");if(!n)throw Error("mediaPayload required.");if("string"!=typeof s)throw Error("clientId invalid.");if("number"!=typeof t)throw Error("trackId invalid.");if(null!==i&&"string"!=typeof i)throw Error("secretToken invalid.");if(null!==o&&"string"!=typeof o)throw Error("requestAuthorizaton invalid.");this._loader=e,this._clientId=s,this._requestAuthorization=o,this._trackId=t,this._trackAuthorization=r,this._secretToken=i,this._mediaPayload=n,this._excludedRenditions=a}getTrackId(){return this._trackId}excludeRendition(e){0>this._excludedRenditions.indexOf(e)&&this._excludedRenditions.push(e)}getUrl({snippet:e,qualities:i=[r.Quality.SQ]}){return new t.helpers.abortableJob.AbortableJob(()=>{let n=this._mediaPayload.transcodings.map(t=>{let{protocol:n,mime_type:s}=t.format,o=this._lookupRendition(n,s),a=(0,r.resolveQuality)(t.quality);return a&&o&&-1===this._excludedRenditions.indexOf(o)&&t.snipped===e&&i.indexOf(a)>=0?{rendition:o,transcoding:t,quality:a,preset:t.preset}:null}).filter(Boolean);if(!n.length)return{result:t.helpers.Promise.resolve(null)};let s=t.helpers.deferred.buildDeferred(),{transcoding:o,rendition:a,quality:l,preset:u}=n[0],h=this._retrieveStreamUrl(o.url);return h.onCompletion(e=>{s.resolve({success:!0,url:e,rendition:a,quality:l,preset:u,timeRetrieved:t.helpers.time.now()})}),h.onError(e=>{e instanceof r.UrlRetrieverError?s.resolve({success:!1,error:e,rendition:a,quality:l,preset:u,timeRetrieved:t.helpers.time.now()}):s.reject(e)}),{result:s.promise,abort:()=>h.abort()}}).run()}updateRequestAuthorization(e){if(null!==e&&"string"!=typeof e)throw Error("requestAuthorizaton invalid.");this._requestAuthorization=e}updateMediaPayload(e){if(!e||"object"!=typeof e)throw Error("mediaPayload invalid.");this._mediaPayload=e}updateTrackAuthorization(e){if(null!==e&&"string"!=typeof e)throw Error("trackAuthorization invalid.");this._trackAuthorization=e}_lookupRendition(e,r){let n=function(e){switch(e){case"encrypted-hls":case"ctr-encrypted-hls":case"cbc-encrypted-hls":case"hls":return e;case"progressive":return"http"}return null}(e);if(!n)return null;let s=function(e){let t=i.exec(e);return t?{mimeType:t[1],audioCodec:t[2]?{id:t[2]}:void 0,videoCodec:t[3]?{id:t[3]}:void 0}:null}(r);return s&&t.helpers.find(a,e=>{let t=e.maestroSegmentFormat||e.maestroFormat;return e.scProtocol===n&&t.mimeType===s.mimeType&&!t.audioCodec==!s.audioCodec&&(!t.audioCodec||!s.audioCodec||t.audioCodec.id===s.audioCodec.id)&&!t.videoCodec==!s.videoCodec&&(!t.videoCodec||!s.videoCodec||t.videoCodec.id===s.videoCodec.id)})||null}_retrieveStreamUrl(i){return new t.helpers.abortableJob.AbortableJob(()=>{let n=t.helpers.deferred.buildDeferred(),s=o.execute(()=>{let t=this._requestAuthorization?{Authorization:this._requestAuthorization}:{},s={client_id:this._clientId};this._secretToken&&(s.secret_token=this._secretToken),this._trackAuthorization&&(s.track_authorization=this._trackAuthorization);let o=function(t,r){let i=(0,e.parseURL)(t);if(!i)throw Error("Unable to parse url.");let n=i.query.slice(1).split("&").filter(Boolean),s=Object.create(null);n.forEach(e=>{let t=e.split("=",2);s[encodeURIComponent(t[0])]=t.length>1?decodeURIComponent(e.slice(e.indexOf("=")+1)):void 0});let o=Object.assign(Object.assign({},s),r);return i.query="?"+Object.keys(o).map(e=>{let t=encodeURIComponent(e),r=o[e];return r&&(t+="="+encodeURIComponent(r)),t}).join("&"),(0,e.buildURLFromParts)(i)}(i,s),a=this._loader.request({url:o,headers:t}).getResponse().then(e=>{if(!e)throw new r.UrlRetrieverError("TIMED_OUT",!0);if(200!==e.statusCode)throw new r.UrlRetrieverError(`INVALID_STATUS_${e.statusCode}`,429===e.statusCode);let t=e.getData();if(!t)throw new r.UrlRetrieverError("NO_DATA");let i=JSON.parse(t).url;if("string"!=typeof i||!i)throw new r.UrlRetrieverError("NO_STREAM_URL");return i}).catch(e=>{if(e instanceof r.UrlRetrieverError)throw e;throw new r.UrlRetrieverError("UNEXPECTED_ERROR",!1,e)});return n.resolve(a),a});return{result:n.promise,abort:()=>s.abort()}}).run()}}let u="24.1.3",h=1201})(),s})(),e.exports=i(r(18471),r(49680))}}]);